<html>
<head>
  <title>MusicXML -> VexFlow Demo 3</title>
  <meta name="viewport" content="initial-scale = 1.0, minimum-scale = 1.0, maximum-scale = 1.0, user-scalable = no">

  <!-- VexFlow Compiled Source -->
  <!--<script src="../node_modules/vexflow/releases/vexflow-min.js"></script>-->
  <script src="http://localhost/dev2.5/inc/vexflow-musicxml-master/vexflow.musicxml.js"></script>

  <!-- Support Sources -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <!--<script src="../support/jquery.js"></script>-->
  <!--<script src="../support/raphael.js"></script>-->

  <style type="text/css">
    div.content {
      overflow: hidden;
      width: 100%;
      padding: 0; margin: 0;
    }
  </style>

  <script>
		var strTest = '<?xml version="1.0"?><score-partwise version="3.0"><part-list><score-part id="P1"><part-name>Music</part-name>    </score-part><score-part id="P3"><part-name>Music3</part-name></score-part></part-list><part id="P1"><measure number="1"><attributes><divisions>1</divisions><key><fifths>0</fifths></key><time><beats>4</beats><beat-type>4</beat-type></time><clef><sign>G</sign><line>2</line></clef></attributes><note><pitch><step>C</step><octave>4</octave></pitch><duration>4</duration><type>whole</type></note></measure><measure number="2"><attributes><divisions>1</divisions><key><fifths>3</fifths></key><time><beats>3</beats><beat-type>4</beat-type></time><clef><sign>G</sign><line>2</line></clef></attributes><note><pitch><step>G</step><alter>1</alter><octave>4</octave></pitch><duration>3</duration><type>whole</type></note></measure></part><part id="P3"><measure number="1"><attributes><divisions>1</divisions><key><fifths>0</fifths></key><time><beats>4</beats><beat-type>4</beat-type></time><clef><sign>F</sign><line>4</line></clef></attributes><note><pitch><step>C</step><octave>4</octave></pitch><duration>2</duration><type>half</type></note><note><pitch><step>B</step><alter>-1</alter><octave>3</octave></pitch><duration>2</duration><type>half</type></note></measure></part></score-partwise>';
	
		//var str = "<root><customer name='John' address='Chicago'></customer></root>";
		
        function CreateXMLDocument (serializedXml) {
            var xmlDoc = null;
            if (window.DOMParser) {
                var parser = new DOMParser ();
                xmlDoc = parser.parseFromString (serializedXml, "text/xml");
            } else if (window.ActiveXObject) {
                xmlDoc = new ActiveXObject ("Microsoft.XMLDOM");
                xmlDoc.async = false;
                xmlDoc.loadXML (serializedXml);
            }

            //var customerNode = xmlDoc.getElementsByTagName ("customer")[0];
            //var customerName = customerNode.getAttribute ("name");
            //alert ("The name of the first customer is " + customerName);
			//document.getElementById("src_viewer").innerHTML = xmlDoc;
			return xmlDoc;
        }
  
    var VexDocument = null;
    var VexFormatter = null;

	//DONE: ================= input from variable instead of URL =======================
	//DONE: include this in C:\Program Files\wamp\www\dev2.5\get_music_form3.htm
	/*
    $.ajax({
      url: "w157.xml",
      success: function(data) {
        var start = new Date().getTime(); // time execution

		//console.log(data);
		//data = CreateXMLDocument(strTest);
		
        VexDocument = new Vex.Flow.Document(data);
        //console.log(VexDocument);
        var content = $(".content")[0];
        if (VexDocument) {
          VexFormatter = VexDocument.getFormatter();
          VexFormatter.draw(content);
        }
        var elapsed = (new Date().getTime() - start)/1000;
        var debouncedResize = null;
        $(window).resize(function() {
          if (! debouncedResize)
            debouncedResize = setTimeout(function() {
              VexFormatter.draw(content);
              debouncedResize = null;
            }, 500);
        });
      }
    });
	*/
	  
	  $( document ).ready(function() {
		var start = new Date().getTime(); // time execution

		//console.log(data);
		data = CreateXMLDocument(strTest);
		
        VexDocument = new Vex.Flow.Document(data);
        //console.log(VexDocument);
        var content = $(".content")[0];
        if (VexDocument) {
          VexFormatter = VexDocument.getFormatter();
          VexFormatter.draw(content);
        }
        var elapsed = (new Date().getTime() - start)/1000;
        var debouncedResize = null;
        $(window).resize(function() {
          if (! debouncedResize)
            debouncedResize = setTimeout(function() {
              VexFormatter.draw(content);
              debouncedResize = null;
            }, 500);
        });
	  });
  </script>
</head>

<body>
  <div class="content" id="viewer" style="padding-bottom: 5pt"></div>
  <div id="src_viewer" style="padding-bottom: 5pt"></div>
</body>
</html>
